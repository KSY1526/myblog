---
toc: true
layout: post
description: 부스트캠프 33, 34, 35일차 간단한 회고.
categories: [BoostCamp, Recommender system, PStage]
title: "[BoostCamp]Day35 PStage8,9,10"
search_exclude: False
---
# 33, 34, 35일차 간단한 회고

대회에 계속 집중하느라 개인 블로그에 매일 기록하던 습관도 끊겼군요.

수요일엔 여러 작업을 계속 도전하느라, 목요일은 오프라인으로 작업하느라 미뤄왔습니다.

매일매일 적는것 보다 회고 능률이 떨어지지만 기억을 되살려서 적어보겠습니다.

## 33일차

CatBoost에서 많지 않은 범주에 대해 Others 처리를 하지 '않은' 것이 좋았었는데요. 범주형 데이터를 처리하는데 특화된 CatBoost와 달리 오버피팅이 쉽게 발생하는 딥러닝 모델 특성상 세심하게 다뤄주는 것이 중요합니다.

즉 CatBoost와 달리 딥러닝 모델에선 많지 않는 범주에 대해 Others 처리를 해주면 어떤가 아이디어가 떠올랐습니다.

단순한 FM 모델에 이 사실을 적용시켜서 이전과 비교했을 때 rmse score가 어떤지 살펴봤는데요. Test 기준 약 2.24로 뛰어나진 않지만 이전보다는 효과가 있음을 느꼈습니다.

이 부분에서 용기를 얻고 이전부터 도입을 고려한 (아이디어를 제공하신 분 너무 감사합니다) FFM + DCN을 적용하였습니다.

이 과정에서 Wandb 내 Sweep 기능을 사용했는데요. 단순 FM 모델보다 하이퍼파라미터 튜닝을 할 값이 많아졌고 시각적으로 인사이트를 얻기 좋았습니다.

![wandb](https://user-images.githubusercontent.com/79916736/199975732-b30adf2c-9d45-4e6e-a077-d1936e4940e4.png)

Sweep에는 다양한 기능 중 하나를 소개하면 하이퍼파라미터 별 변수 중요도, 상관계수를 표시해주는 기능입니다. 어느 하이퍼파라미터를 튜닝해야할 지 직관적으로 알게됩니다.

이 과정에서 범주형 변수별로 Others를 적용하는 기준 N 값을 하이퍼파라미터로 적용시켜봤습니다. 

이 모델을 리더보드에 적용했는데요. Valid Score와 다르게 Test Score는 약 2.3으로 노말 FM보다는 떨어진 모습입니다.

왜 그런지 원인을 모르겠네요.

## 34일차

왜 FFM+DCN 모델이 잘 작동하지 않을 까 고민하면서 코드를 계속 검정해봤습니다.

확실하진 않지만 검수 과정에서 .py 디렉토리 구조에 어색해서 실수한 부분이 있는 것 같습니다.

같은 작업을 진행중인 팀원 중 한명은 주피터노트북을 이용해 전 과정을 한번에 정리했는데요.

.py 파일에 적응 해야지 하면서도 이런 상황에서는 주피터노트북이 편하긴 하구나 생각이 들었습니다.

그 팀원 덕분에 FFM+DCN 모델이 수준급 성능을 뽑아낼 수 있었습니다. 다만 아직 딥러닝이라는 벽을 내 손으로 극복하지 못햇다는 아쉬움이 있네요.

나머지 시간에는 K-Fold와 Optuna를 이용해 컴퓨터 자원으로 리더보드를 조금이라도 올리고자 노력했습니다.

이전에 구현했던 CatBoost와 팀원이 개발한 FFM+DCN 모델에 10 K-Fold + Optuna를 적용한 결과 2등 팀과 꽤 스코어를 벌리는 2.10x 값이 나오게 되었습니다.

최종 1등을 달성하게 되었고 아쉬운 점도 많이 있지만 정말 뿌듯했습니다.

이 날 오프라인으로 팀원을 모두 만나 같이 작업진행했는데 성과도 잘 나오고 소통도 더 잘 되는 느낌이라 만나길 잘했다는 생각이 들었고 같이 저녁 먹으니깐 제대로 뒷풀이 느낌이 나서 너무 좋았습니다.

## 35일차

괜히 발표하고 싶다고 해서 아침부터 팀원들에게 발표자료 만들자고 고생시킨 것 같습니다. 단기간에 고퀄리티 발표자료를 만들어줘서 너무 고마웠습니다.

Level 2 팀원을 한명 더 구했습니다. 분위기 해치는 사람만 아니면 사람 한명 더 있는게 무조건 좋을 것 같아요.

Wrap up ('렙'업) 리포트도 쓰기 참 귀찮았지만 어제 미리 써놔서 그나마 꾸역꾸역 썼던 것 같습니다.

마스터 클래스에서 1등 팀이라는 부담스러운 칭호로 발표를 진행했는데 생각보다 다들 좋은 말도 많이해주시고 설명이 부족했지만 이해도 잘해주시고 마스터님에게도 긍정적인 피드벡을 많이 받았습니다. 이외에도 팀원들도 격려해주고 DM으로 발표 잘 들었다고 연락도 받고 엄청 뿌듯했습니다.

대회 기간 고생했던 것을 보상받는 느낌이라 너무 좋았고 아쉬운 것도 분명 많지만 내가 가고 있는 방향이 틀린 방향은 아니구나, 열심히만 하면 되겠구나 라는 자신감을 얻었습니다.

## 다음 주

다음 주에는 AI 서비스 개발 기초 강의를 진행합니다. 멘토님도 그렇고 한 숨 돌리는 주라고 하는데요.

개인적으로 분량이 안 빡세도 많이 배우고 싶었던 부분이기도 하고 제가 가장 못하는 부분이기도 해서 고생하는 내 자신이 벌써 보이는 것 같아요.

그래도 최고의 환경 속에서 한 걸음씩 나아간다 생각하고 주말에 리프래쉬 잘 하고 다시 돌아오겠습니다.