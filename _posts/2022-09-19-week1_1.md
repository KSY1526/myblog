---
toc: true
layout: post
description: 부스트캠프 1일차 공부 정리.
categories: [BoostCamp, Gradient Descent, math, markdown]
title: "[BoostCamp]Day1"
---
# 1일차 공부 정리 (업데이트중)

## 무어-펜로즈(Moore-Penrose) 역행렬

우선 역행렬부터 간단히 정의하면 어떤 행렬에 대해 행렬곱을 진행할 때(방향 상관 없이) 항등행렬이 나오는 행렬을 그 행렬의 역행렬이라고 합니다.

행과 열 길이가 같고 행렬식이 0이 아닌 경우 역행렬은 항상존재합니다만, 앞으로 다룰 행렬이 대부분 행과 열 길이가 다른 행렬입니다.

이 경우 행렬 곱 순서에 따라 다른 행렬이 나오기 때문에 역행렬을 정의할 수 없습니다.

다만 역행렬에 기능을 유사하게 수행하기 위해 무어-펜로즈 역행렬을 다음과 같이 정의합니다.

행이 열보다 길이가 긴 경우 $A^+ = (A^TA)^{-1}A^T$, 열이 행보다 길이가 긴 경우 $A^+ = A^T(A^TA)^{-1}$ 입니다.

행이 열보다 길이가 긴 경우 $A^+A = I_{m}$, 열이 행보다 길이가 긴 경우 $AA^+ = I_{n}$ 을 만족합니다.

행과 열 중 길이가 작은 값 기준으로 항등행렬이 생성된다고 생각하면 기억이 오래갈 것 같네요.

## 몬테카를로 샘플링

기계학습을 진행하게 되면 확률분포를 명시적으로 모르는 경우가 대부분입니다.

확률분포를 모를 때 데이터를 이용해서 기대값을 계산하는 방법으로 몬테카를로 샘플링 방법을 사용합니다.

![수식](https://velog.velcdn.com/images%2Fminchoul2%2Fpost%2F0a026fc4-1220-41fe-9f6a-2a2d9268bd71%2Fimage.png)

위 수식에서 x는 데이터를, f는 타겟으로 하는 함수를 의미합니다. 데이터들을 추출해 함수에 대입한 뒤 값을 평균내는 식으로 진행하게 됩니다.

![함수](https://velog.velcdn.com/images%2Fminchoul2%2Fpost%2Fae648032-6c68-42b6-a69e-17e5cd938077%2Fimage.png)

예시를 통해 이해하면 쉬운데요. 윗 함수의 [-1,1] 범위 내 적분값을 구하는 것을 몬테카를로 샘플링을 이용해보겠습니다.

'''python

    import numpy as np

    # 범위 내 함수 적분 값 구하는 몬테카를로 샘플링 함수(시뮬레이션)
    def mc_int(fun, low, high, sample_size = 100, repeat = 10):
        int_len = np.abs(high - low) # x축 길이(범위)
        stat = []

        # 이 행위 repeat만큼 반복
        for _ in range(repeat):
            # 범위 내 값 sample_size 만큼 뽑기.
            x = np.random.uniform(low = low, high = high, size = sample_size)
            # y 값 추출
            fun_x = fun(x)
            # x축길이(가로) + 평균 구하기(세로)
            int_val = int_len * np.mean(fun_x)
            stat.append(int_val)
        
        # 평균 뿐만 아니라 반복 수행했기 때문에 표준편차도 구할 수 있음.
        # 표준편차로 이 값의 오차범위를 알 수 있음.
        return np.mean(stat), np.std(stat)

    def f_x(x):
        return np.exp(-x**2)

    print(mc_int(f_x, low = -1, high = 1, sample_size=10000, repeat=100))
    # (1.4941721073750045, 0.0043400930289970545)
    # 다른방법으로 계산한 값 : 1.49364

'''

참고 : https://velog.io/@minchoul2/%EB%AA%AC%ED%85%8C%EC%B9%B4%EB%A5%BC%EB%A1%9C-%EC%83%98%ED%94%8C%EB%A7%81-for-AI