<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Your Brand - [DACON] 사물 이미지 분류 경진대회 With Pytorch</title> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" media="print" onload="this.media='all'"> <noscript> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"> </noscript> <link rel="shortcut icon" href="/myblog/assets/img/favicons/favicon.ico"> <link rel="icon" type="image/png" sizes="32x32" href="/myblog/assets/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/myblog/assets/img/favicons/favicon-16x16.png"> <link rel="apple-touch-icon" sizes="180x180" href="/myblog/assets/img/favicons/apple-touch-icon.png"> <link rel="manifest" href="/myblog/assets/manifest.json"> <meta name="mobile-web-app-capable" content="yes"> <meta name="theme-color" content="#f0f0f0"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-title" content="Your Brand's App"> <meta name="apple-mobile-web-app-status-bar-style" content="default"> <meta name="msapplication-TileColor" content="#2d89ef"> <meta name="msapplication-starturl" content="/myblog/"> <meta name="application-name" content="Your Brand's App"> <meta name="msapplication-config" content="/myblog/assets/img/favicons/browserconfig.xml"> <meta name="keywords" content=""> <meta name="description" content="Your meta description."> <meta name="robots" content="index, follow"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="[DACON] 사물 이미지 분류 경진대회 With Pytorch"> <meta name="twitter:description" content="Your meta description."> <meta name="twitter:image" content="https://ksy1526.github.io/myblog/assets/img/about/about.jpg"> <meta property="og:site_name" content="Your Brand"> <meta property="og:type" content="website"> <meta property="og:title" content="[DACON] 사물 이미지 분류 경진대회 With Pytorch"> <meta property="og:description" content="Your meta description."> <meta property="og:url" content="https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html"> <meta property="og:image" content="https://ksy1526.github.io/myblog/assets/img/about/about.jpg"> <script type="application/ld+json">{ "@context": "https://schema.org" ,"@graph": [ { "@type": "Person" ,"@id": "https://ksy1526.github.io/myblog/#person" ,"name": "Seong Yeon Kim" ,"url": "" ,"image": "https://ksy1526.github.io/myblog/assets/img/about/about.jpg" ,"description": "Your meta description." },{ "@type": "WebSite" ,"@id": "https://ksy1526.github.io/myblog/#website" ,"url": "https://ksy1526.github.io/myblog/" ,"name": "Your Brand" ,"description": "Your meta description." ,"publisher": {"@id": "https://ksy1526.github.io/myblog/#person"} ,"inLanguage": "en-US" ,"copyrightHolder" : {"@id": "https://ksy1526.github.io/myblog/#person"} ,"copyrightYear" : "2022" },{ "@type": "WebPage" ,"@id": "https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html#webpage" ,"url": "https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html" ,"name": "[DACON] 사물 이미지 분류 경진대회 With Pytorch" ,"isPartOf": {"@id": "https://ksy1526.github.io/myblog/#website"} ,"breadcrumb": {"@id": "https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html#breadcrumb"} ,"primaryImageOfPage": "https://ksy1526.github.io/myblog/assets/img/about/about.jpg" ,"description": "Your meta description." ,"inLanguage": "en-US" ,"potentialAction": { "@type": "ReadAction" ,"target": "https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html" } },{ "@type": "BreadcrumbList", "@id": "https://ksy1526.github.io/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html#breadcrumb", "itemListElement": [ { "@type": "ListItem" ,"position": 1 ,"name": "Home" ,"item": "https://ksy1526.github.io/myblog/" }, { "@type": "ListItem" ,"position": 2 ,"name": "[DACON] 사물 이미지 분류 경진대회 With Pytorch" } ] } ] }</script> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <link href="/myblog/assets/css/main.css" rel="stylesheet"><link href="/myblog/assets/css/nav-media.css" rel="stylesheet"> </head> <body > <script src="/myblog/assets/js/color-scheme-attr-init.js" data-mode="false"></script> <nav class="navbar navbar-default top-nav"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed pull-left top-nav-menu-toggle" data-toggle="collapse" data-target="#id_top-nav-menu-toggle" aria-expanded="false"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand top-nav-brand" href="/myblog/" translate="no">Your Brand</a> </div> <div class="color_scheme_switch_top_holder" data-toggle="tooltip" data-placement="bottom" title="Color scheme"> <label class="color-scheme-switch hover-effect"> <input type="checkbox" class="checkbox_color_switch" /> <span></span> </label> </div> </nav> <nav id="side-nav-container"> <div class="side-nav"> <div class="side-nav-brand"> <img src="/myblog/assets/img/posts/post_pic1.jpg" alt=""> <div class="brand-holder"> <a href="/myblog/" translate="no">Your Brand</a> </div> <p>&nbsp;Sample</p> <br> </div> <br> <a href="javascript:void(0);" class="side-nav-close"> <i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i> </a> <hr> <br> <div class="side-nav-buttons"> <ul class="nav nav-pills nav-stacked"> <li ><a href="/myblog/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page2/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page3/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page4/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page5/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page6/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li></ul> </div> <br> <br> <hr id="toc-view-top"> <div class="side-nav-footer" translate="no"> <p>&copy; 2022 Your Brand.</p> </div> </div> <div class="side-nav-bottom-buttons-container"> <hr> <ul> <li><div class="color_scheme_switch_side_holder" data-toggle="tooltip" data-placement="top" title="Color scheme"> <label class="color-scheme-switch hover-effect"> <input type="checkbox" class="checkbox_color_switch" /> <span></span> </label> </div> </li><li><div class="cookie-icon hover-effect" onclick="CookieConsent.showSettings();" data-toggle="tooltip" data-placement="top" title="Cookie settings"> <div class="cookie-wrapper"> <i class="fa fa-circle bitten-cookie" aria-hidden="true"></i> <i class="fa fa-circle small-ellipse-icon" aria-hidden="true"></i> <i class="fa fa-spinner inner-icon" aria-hidden="true"></i> <i class="fa fa-circle-thin outer-icon" aria-hidden="true"></i> </div> </div> </li></ul> </div></nav> <div id="main-wrapper"> <div class="main-container"><article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title p-name" itemprop="name headline">[DACON] 사물 이미지 분류 경진대회 With Pytorch</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-02-24T00:00:00-06:00" itemprop="datePublished"> Feb 24, 2022 </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span class="p-author h-card" itemprop="name">Seong Yeon Kim</span></span> • <span class="read-time" title="Estimated read time"> 13 min read </span></p> <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> <a class="category-tags-link" href="/myblog/categories/#jupyter">jupyter</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#Deep Learning">Deep Learning</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#Pytorch">Pytorch</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#DACON">DACON</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#Classifier">Classifier</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#conputer vision">conputer vision</a> </p> <div class="pb-5 d-flex flex-wrap flex-justify-end"> </div> </header> <div class="post-content e-content" itemprop="articleBody"> <!-- ################################################# ### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ### ################################################# # file to edit: _notebooks/2022-02-24-torch4.ipynb --> <div class="container" id="notebook-container"> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p><a href="https://colab.research.google.com/github/KSY1526/myblog/blob/master/_notebooks/2022-02-24-torch4.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#45936;&#51060;&#53552;-&#44396;&#44544;-&#46300;&#46972;&#51060;&#48652;&#50640;-&#51200;&#51109;&#54616;&#44592;">&#45936;&#51060;&#53552; &#44396;&#44544; &#46300;&#46972;&#51060;&#48652;&#50640; &#51200;&#51109;&#54616;&#44592;<a class="anchor-link" href="#&#45936;&#51060;&#53552;-&#44396;&#44544;-&#46300;&#46972;&#51060;&#48652;&#50640;-&#51200;&#51109;&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&#34;/content/drive&#34;, force_remount=True).
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>코랩과 구글 드라이브를 연동하는 코드입니다. 구글 드라이브 내 파일을 코랩에서도 접근할 수 있게됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="c1"># !unzip -qq &#39;/content/drive/MyDrive/ObjectDetect/data.zip&#39;</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>데이터를 저장하는 다른 더 좋고 빠른 방법이 있을 수도 있는데, 제가 발견한 방법 중 가장 좋은 방법을 소개합니다.</p> <p>우선 데이콘 내 데이터를 압축된 형태로 다운받고, 구글 드라이브 내 압축된 파일 그대로 업로드 합니다.</p> <p>(제 기준 /content/drive/MyDrive/ObjectDetect 공간에 data.zip 파일을 넣었습니다. 여러분 상황에 맞게 주소를 바꾸시면 됩니다.)</p> <p>그 후 위 코드를 주석을 해제한 뒤 주소를 data.zip을 저장한 위치로 수정하시고 코드를 실행하시면 약 5분 뒤 압축 해제가 잘 됩니다.</p> <p>압축 해제 후 구글 드라이브 업로드, 구글 드라이브 내 압축 해제보다는 이 방법이 괜찮은 것 같아 소개합니다.</p> <p>더 좋은 방법 있으면 같이 공유 부탁드려요~</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#54596;&#50836;&#54620;-&#54056;&#53412;&#51648;-&#49444;&#52824;&#54616;&#44256;-&#44592;&#48376;-&#49444;&#51221;-&#54616;&#44592;">&#54596;&#50836;&#54620; &#54056;&#53412;&#51648; &#49444;&#52824;&#54616;&#44256; &#44592;&#48376; &#49444;&#51221; &#54616;&#44592;<a class="anchor-link" href="#&#54596;&#50836;&#54620;-&#54056;&#53412;&#51648;-&#49444;&#52824;&#54616;&#44256;-&#44592;&#48376;-&#49444;&#51221;-&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Callable</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">PIL</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">imshow</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">Tensor</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>

<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">torchinfo</span>
<span class="kn">from</span> <span class="nn">torchinfo</span> <span class="kn">import</span> <span class="n">summary</span>

<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet50</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span><span class="p">,</span> <span class="n">tqdm_notebook</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>Requirement already satisfied: torchinfo in /usr/local/lib/python3.7/dist-packages (1.6.3)
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치, 넘파이, 판다스 등 필요한 패키지를 임포트 했습니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/ObjectDetect/&#39;</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;airplane&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;automobile&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s1">&#39;deer&#39;</span><span class="p">,</span>
          <span class="mi">5</span><span class="p">:</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="s1">&#39;frog&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="s1">&#39;ship&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span><span class="s1">&#39;truck&#39;</span><span class="p">}</span>

<span class="c1"># gpu 사용중일땐 cuda, gpu 사용 불가능할땐 cpu 사용.</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>

<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>
<span class="k">if</span> <span class="n">device</span> <span class="o">==</span><span class="s1">&#39;cuda&#39;</span><span class="p">:</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>데이터의 저장 위치와 배치 사이즈, 에포크 수, 러닝 레이트 값, 장치 등을 지정했습니다.</p> <p>각 레이블 번호는 알파벳 순서대로 배정했습니다.</p> <p>이 코드를 따라하신다면 path만 파일 저장 위치로 바꾸시면 됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#45936;&#51060;&#53552;-&#48520;&#47084;&#50724;&#44592;">&#45936;&#51060;&#53552; &#48520;&#47084;&#50724;&#44592;<a class="anchor-link" href="#&#45936;&#51060;&#53552;-&#48520;&#47084;&#50724;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;train/airplane/0001.jpg&#39;</span><span class="p">)</span> 
<span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>&lt;matplotlib.image.AxesImage at 0x7fcd91417310&gt;</pre></div> </div> <div class="output_area"> <div class="output_png output_subarea "> <img src="/myblogdata:image/png;base64,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 " /> </div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>PIL와 matplotlib 패키지를 가지고 이미지를 시각화 할 수 있습니다.</p> <p>데이터 분석을 하기 전 그래도 이미지 데이터인데 한번 시각적으로 확인했습니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">train_images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">train_labels</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;train/*&quot;</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;/*.jpg&quot;</span><span class="p">)):</span>
        <span class="n">an_img</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="c1"># 이미지를 읽습니다.</span>
        <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">an_img</span><span class="p">)</span> <span class="c1"># 이미지 데이터를 숫자로 변환합니다.</span>
        <span class="n">train_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img_array</span><span class="p">)</span> <span class="c1"># 리스트에 데이터 실기.</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">i</span> 
        <span class="n">train_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># 다음 폴더에는 다음 라벨</span>

<span class="n">train_images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_images</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>100%|██████████| 5000/5000 [00:16&lt;00:00, 302.23it/s]
100%|██████████| 5000/5000 [00:18&lt;00:00, 270.39it/s]
100%|██████████| 5000/5000 [00:18&lt;00:00, 266.35it/s]
100%|██████████| 5000/5000 [00:12&lt;00:00, 404.58it/s]
100%|██████████| 5000/5000 [00:13&lt;00:00, 358.46it/s]
100%|██████████| 5000/5000 [00:11&lt;00:00, 418.30it/s]
100%|██████████| 5000/5000 [00:11&lt;00:00, 425.91it/s]
100%|██████████| 5000/5000 [00:12&lt;00:00, 392.43it/s]
100%|██████████| 5000/5000 [00:12&lt;00:00, 397.02it/s]
100%|██████████| 5000/5000 [00:12&lt;00:00, 404.29it/s]
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>(50000, 32, 32, 3)
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 내 ImageFolder 함수를 사용하는 것이 편리하지만, 이후 모델 학습시 데이터를 찾을때 계속 구글드라이브를 탐색하는 형태이기 때문에 지나치게 느립니다.</p> <p>그래서 트레인 데이터를 폴더 별로 반복문을 사용해 모두 직접 다운로드 하였습니다.</p> <p>sorted로 폴더 이름을 정렬한 뒤 i를 업데이트 했기 때문에 알파벳 순서대로 라벨 숫자를 입력했습니다.</p> <p>입력된 데이터를 관찰하면 개수가 5만개이며 32 * 32 이미지 픽셀이고, 3채널(RGB값) 으로 구성되있습니다!</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">test_images</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;test/*.jpg&quot;</span><span class="p">))):</span>
    <span class="n">an_img</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="c1"># 이미지를 읽습니다.</span>
    <span class="n">img_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">an_img</span><span class="p">)</span> <span class="c1"># 이미지 데이터를 숫자로 변환합니다.</span>
    <span class="n">test_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img_array</span><span class="p">)</span> <span class="c1"># 리스트에 데이터 실기.</span>

<span class="n">test_images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>100%|██████████| 10000/10000 [00:25&lt;00:00, 385.08it/s]
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>테스트 데이터도 마찬가지로 진행했습니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#48520;&#47084;&#50728;-&#45936;&#51060;&#53552;&#47196;-&#45936;&#51060;&#53552;-&#49483;-&#47564;&#46308;&#44592;">&#48520;&#47084;&#50728; &#45936;&#51060;&#53552;&#47196; &#45936;&#51060;&#53552; &#49483; &#47564;&#46308;&#44592;<a class="anchor-link" href="#&#48520;&#47084;&#50728;-&#45936;&#51060;&#53552;&#47196;-&#45936;&#51060;&#53552;-&#49483;-&#47564;&#46308;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">CustomDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span> 
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;train&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">img_list</span> <span class="o">=</span> <span class="n">train_images</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">img_labels</span> <span class="o">=</span> <span class="n">train_labels</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">img_list</span> <span class="o">=</span> <span class="n">test_images</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">img_labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10000</span> <span class="c1"># 형식을 맞추기 위해</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">img_labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 내 Dataset 클래스를 상속해서 Dataset을 정의했습니다. 뒤에 다루는 DataLoader 클래스와 호환이 되기 때문에 반드시 필요합니다.</p> <p>추상 클래스이기 때문에 반드시 새로 정의해야 하는 함수는 init, len, getitem 입니다.</p> <p>init 부분은 클래스 선언시 자동으로 실행되는 함수입니다. 생성자 개념이죠. 이미지 데이터와 라벨값을 저장해줍니다.</p> <p>이때 테스트 데이터는 라벨이 없지만, 형식을 맞춰주기 위해 임의로 0라벨을 붙히겠습니다.</p> <p>len 부분은 데이터 길이만 배출하면 됩니다. getitem 부분은 정해진 인덱스의 데이터를 출력해줘야 합니다.</p> <p>DataLoader가 len과 getitem 함수를 사용하기 때문에 잘 정의해야합니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">tensor</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()]</span>
<span class="p">)</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">CustomDataset</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">CustomDataset</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 모델은 텐서 단위로 다루기 때문에 텐서로 변환하는 transforms 을 만든 뒤 데이터 셋을 만듭니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">meanRGB</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">train_set</span><span class="p">]</span>
<span class="n">stdRGB</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">train_set</span><span class="p">]</span>

<span class="n">meanR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meanRGB</span><span class="p">])</span>
<span class="n">meanG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meanRGB</span><span class="p">])</span>
<span class="n">meanB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meanRGB</span><span class="p">])</span>

<span class="n">stdR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stdRGB</span><span class="p">])</span>
<span class="n">stdG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stdRGB</span><span class="p">])</span>
<span class="n">stdB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stdRGB</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">meanR</span><span class="p">,</span> <span class="n">meanG</span><span class="p">,</span> <span class="n">meanB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stdR</span><span class="p">,</span> <span class="n">stdG</span><span class="p">,</span> <span class="n">stdB</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.49125046 0.48208782 0.44651186
0.20106333 0.19889629 0.20135581
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>입력된 이미지 데이터를 정규화(표준화) 시켜주겠습니다. 정규화를 위해서 표본 평균과 표준오차를 구하는 모습입니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">([</span><span class="n">meanR</span><span class="p">,</span> <span class="n">meanG</span><span class="p">,</span> <span class="n">meanB</span><span class="p">],</span> <span class="p">[</span><span class="n">stdR</span><span class="p">,</span> <span class="n">stdG</span><span class="p">,</span> <span class="n">stdB</span><span class="p">])</span>
<span class="p">])</span>

<span class="n">train_set</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
<span class="n">test_set</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 내 Compose 함수를 한번 더 사용하고, 앞서 구한 표본평균과 표준오차를 이용해 transform을 만들었습니다.</p> <p>데이터를 데이터 셋 형태로 정리했기 때문에 'train_set.transform = transform' 이 코드만 사용하면 간편하게 적용이 가능합니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">train_set</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>50000</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">train_set</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>(tensor([[[-0.5124, -0.5124, -0.4538,  ..., -0.4343, -0.4538, -0.4538],
          [-0.5124, -0.5124, -0.4538,  ..., -0.4538, -0.4538, -0.4733],
          [-0.5514, -0.5709, -0.5124,  ..., -0.4733, -0.4733, -0.4928],
          ...,
          [-1.6826, -1.6436, -1.6241,  ..., -1.7801, -1.7216, -1.5656],
          [-1.6631, -1.6436, -1.6241,  ..., -1.3510, -1.3705, -1.5071],
          [-1.7606, -1.7411, -1.7216,  ..., -1.7216, -1.7021, -1.5656]],
 
         [[ 0.2379,  0.2379,  0.2971,  ...,  0.3957,  0.3759,  0.3759],
          [ 0.2379,  0.2379,  0.2971,  ...,  0.3759,  0.3759,  0.3562],
          [ 0.2576,  0.2379,  0.2971,  ...,  0.3562,  0.3562,  0.3365],
          ...,
          [-1.1028, -1.1028, -1.0831,  ..., -1.3591, -1.3591, -1.2014],
          [-1.0831, -1.0634, -1.0831,  ..., -0.9845, -1.0042, -1.1422],
          [-1.1817, -1.1619, -1.1422,  ..., -1.3591, -1.3394, -1.2014]],
 
         [[ 0.4117,  0.4117,  0.4701,  ...,  0.3922,  0.3728,  0.3728],
          [ 0.4117,  0.4117,  0.4701,  ...,  0.3728,  0.3728,  0.3533],
          [ 0.4117,  0.3922,  0.4507,  ...,  0.3533,  0.3533,  0.3338],
          ...,
          [-1.1464, -1.1269, -1.1074,  ..., -1.3411, -1.3216, -1.1658],
          [-1.1269, -1.1074, -1.1074,  ..., -0.9126, -0.9321, -1.0685],
          [-1.2243, -1.2048, -1.1853,  ..., -1.2827, -1.2632, -1.1269]]]), 0)</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>실제 값으로 확인해보면 32 * 32가 맞는것으로 보이며, 뒤에 라벨 값으로 0이 달려있는 모습입니다.</p> <p><strong>len </strong>, <strong>getitem </strong>함수로 데이터 값을 불러올 수 있는 걸 보니 파이토치 내 Dataset 클래스 형태로 데이터가 잘 입력된 것 같습니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#45936;&#51060;&#53552;&#49483;&#51012;-&#45936;&#51060;&#53552;-&#47196;&#45908;&#50640;-&#49892;&#44592;">&#45936;&#51060;&#53552;&#49483;&#51012; &#45936;&#51060;&#53552; &#47196;&#45908;&#50640; &#49892;&#44592;<a class="anchor-link" href="#&#45936;&#51060;&#53552;&#49483;&#51012;-&#45936;&#51060;&#53552;-&#47196;&#45908;&#50640;-&#49892;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_set</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>앞서 정의한 데이터 셋을 파이토치 내 데이터 로더에 실습니다. 이렇게 하는 이유는 배치단위로 모델에 적용하기 쉽기 때문입니다.</p> <p>여기서 중요한 점은 테스트 데이터는 셔플을 해줘야 합니다. 데이터가 라벨 값으로 정렬되어 있는데, 학습에 큰 문제가 되기 때문입니다.</p> <p>셔플을 True로 해주게 되면 또 하나의 장점이 에포크가 바뀔때마다 로더 내 데이터 패치를 다시 섞어줍니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">samples</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">batch_idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>torch.Size([32, 3, 32, 32])
tensor([2, 8, 2, 5, 7, 1, 9, 0, 8, 0, 3, 1, 7, 2, 9, 6, 3, 6, 2, 9, 2, 1, 5, 5,
        9, 8, 2, 8, 1, 6, 5, 1])
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>데이터 로더를 보다 상세히 관찰해보면 배치단위, 채널수, 32 * 32 로 잘 들어가 있는걸 관찰할 수 있으며, 라벨값도 잘 들어가 있습니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#47784;&#45944;-&#47564;&#46308;&#44592;">&#47784;&#45944; &#47564;&#46308;&#44592;<a class="anchor-link" href="#&#47784;&#45944;-&#47564;&#46308;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resnet</span> <span class="o">=</span> <span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resnet</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 내 nn.Module 클래스를 상속하고 resnet50 을 사용하여 모델을 정의했습니다.</p> <p>이때 대회 규칙 상 사전학습이 안되므로 pretrained=False 로 잘 지정해줘야합니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)))</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
Model                                         --                        --
├─ResNet: 1-1                                 [1, 1000]                 --
│    └─Conv2d: 2-1                            [1, 64, 16, 16]           9,408
│    └─BatchNorm2d: 2-2                       [1, 64, 16, 16]           128
│    └─ReLU: 2-3                              [1, 64, 16, 16]           --
│    └─MaxPool2d: 2-4                         [1, 64, 8, 8]             --
│    └─Sequential: 2-5                        [1, 256, 8, 8]            --
│    │    └─Bottleneck: 3-1                   [1, 256, 8, 8]            75,008
│    │    └─Bottleneck: 3-2                   [1, 256, 8, 8]            70,400
│    │    └─Bottleneck: 3-3                   [1, 256, 8, 8]            70,400
│    └─Sequential: 2-6                        [1, 512, 4, 4]            --
│    │    └─Bottleneck: 3-4                   [1, 512, 4, 4]            379,392
│    │    └─Bottleneck: 3-5                   [1, 512, 4, 4]            280,064
│    │    └─Bottleneck: 3-6                   [1, 512, 4, 4]            280,064
│    │    └─Bottleneck: 3-7                   [1, 512, 4, 4]            280,064
│    └─Sequential: 2-7                        [1, 1024, 2, 2]           --
│    │    └─Bottleneck: 3-8                   [1, 1024, 2, 2]           1,512,448
│    │    └─Bottleneck: 3-9                   [1, 1024, 2, 2]           1,117,184
│    │    └─Bottleneck: 3-10                  [1, 1024, 2, 2]           1,117,184
│    │    └─Bottleneck: 3-11                  [1, 1024, 2, 2]           1,117,184
│    │    └─Bottleneck: 3-12                  [1, 1024, 2, 2]           1,117,184
│    │    └─Bottleneck: 3-13                  [1, 1024, 2, 2]           1,117,184
│    └─Sequential: 2-8                        [1, 2048, 1, 1]           --
│    │    └─Bottleneck: 3-14                  [1, 2048, 1, 1]           6,039,552
│    │    └─Bottleneck: 3-15                  [1, 2048, 1, 1]           4,462,592
│    │    └─Bottleneck: 3-16                  [1, 2048, 1, 1]           4,462,592
│    └─AdaptiveAvgPool2d: 2-9                 [1, 2048, 1, 1]           --
│    └─Linear: 2-10                           [1, 1000]                 2,049,000
├─Linear: 1-2                                 [1, 10]                   10,010
===============================================================================================
Total params: 25,567,042
Trainable params: 25,567,042
Non-trainable params: 0
Total mult-adds (M): 85.52
===============================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 3.64
Params size (MB): 102.27
Estimated Total Size (MB): 105.92
===============================================================================================
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치에서 중요하게 알아두어야 할 것이 디바이스(GPU를 주로 사용합니다) 내 실어줘야 하는것이 모델과 입력 값, 라벨 값 입니다.</p> <p>여기서 to(device) 를 사용하여 모델을 디바이스 내 실어주었습니다.</p> <p>앞서 정의한 모델을 직관적으로 관찰하기 위해 torchinfo(summary) 를 사용하였습니다.</p> <p>모델 구조가 복잡한 것도 그렇고, 모델 파라미터는 25,567,042개니 역시 '딥'러닝이네요.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#47784;&#45944;-&#54617;&#49845;&#54616;&#44592;">&#47784;&#45944; &#54617;&#49845;&#54616;&#44592;<a class="anchor-link" href="#&#47784;&#45944;-&#54617;&#49845;&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">learning_rate</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>

        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">200</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">max_vals</span><span class="p">,</span> <span class="n">max_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">targets</span> <span class="o">==</span> <span class="n">max_indices</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">acc</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>201it [00:20,  9.48it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>2.03402, 0.25000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>402it [00:41,  9.71it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.68516, 0.40625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.59it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>2.04422, 0.28125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>802it [01:21,  9.71it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.48867, 0.46875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:41,  9.63it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.43756, 0.46875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:02,  9.70it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.60528, 0.40625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1402it [02:22,  9.63it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.23092, 0.62500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.82it/s]
201it [00:20,  9.62it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.57936, 0.43750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:40,  9.75it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.51674, 0.43750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>602it [01:01,  9.75it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.81981, 0.37500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:21,  9.59it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.41190, 0.56250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1000it [01:42,  9.32it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.63900, 0.40625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:04,  9.56it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.07908, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:26,  9.69it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.33048, 0.56250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:42,  9.62it/s]
201it [00:21,  9.40it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.38050, 0.53125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.25it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.46519, 0.50000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:02,  9.59it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.54906, 0.43750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.61it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.55637, 0.40625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:43,  9.65it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.28245, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:03,  9.77it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.17159, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:24,  9.53it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.21823, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:40,  9.72it/s]
201it [00:20,  9.41it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.38219, 0.53125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.07596, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:02,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.51185, 0.50000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.51it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.88233, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1002it [01:46,  9.64it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.92160, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:07,  9.68it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.87461, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:27,  9.55it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.92864, 0.62500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:44,  9.49it/s]
201it [00:21,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.02033, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:42,  9.56it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.67408, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:03,  6.73it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.29992, 0.53125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:24,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.12536, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:45,  9.60it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.28840, 0.56250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:05,  9.43it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.82536, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:27,  9.25it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.70235, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:44,  9.53it/s]
201it [00:22,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.93481, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:42,  9.29it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.46380, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:03,  9.21it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.15582, 0.56250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:23,  9.25it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.64076, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:44,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.25706, 0.65625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:05,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.23735, 0.65625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:26,  9.52it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.80131, 0.65625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:42,  9.60it/s]
201it [00:20,  9.37it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.81935, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.07775, 0.65625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:02,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.79303, 0.75000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.32it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.60452, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:43,  9.25it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.89765, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:04,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.79112, 0.65625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:24,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.47540, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:41,  9.70it/s]
201it [00:20,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.50384, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:43,  8.21it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.74633, 0.75000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:09,  9.47it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.68515, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:30,  9.59it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.64061, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:50,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.85828, 0.59375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:11,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.45279, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:31,  9.39it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.80346, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:49,  9.25it/s]
201it [00:20,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.44945, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:45,  7.71it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.79414, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:12,  6.42it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.48421, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:33,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.00993, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:54,  9.46it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.53396, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:14,  9.52it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.63844, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:35,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.67957, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:52,  9.07it/s]
201it [00:20,  9.38it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.25926, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.47it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.61564, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.54it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.74993, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.48it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.98167, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1000it [01:43,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.33597, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:03,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.72271, 0.71875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:24,  9.53it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.45406, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:41,  9.71it/s]
201it [00:20,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.57367, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.34390, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>600it [01:01,  9.42it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.66048, 0.75000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.40it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.64899, 0.75000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.51046, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:03,  9.41it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.49834, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:23,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.38570, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:40,  9.75it/s]
201it [00:29,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.44295, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>400it [00:50,  9.39it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.63138, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:10,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.09141, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>800it [01:31,  9.58it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.79246, 0.68750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1000it [01:51,  9.40it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.35505, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:12,  9.74it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.53283, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:32,  9.53it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.32168, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:49,  9.23it/s]
201it [00:20,  9.53it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.25396, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>402it [00:41,  9.67it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.36281, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.56it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.16314, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>802it [01:21,  9.74it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.53413, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1002it [01:42,  9.68it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.17970, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:02,  9.54it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.30832, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:22,  9.51it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.43612, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.80it/s]
201it [00:20,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.28544, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:40,  9.35it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.20452, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>602it [01:01,  9.65it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.57266, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:21,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.44896, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.59it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.07010, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:02,  9.60it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.47427, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1402it [02:23,  9.73it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.28636, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.80it/s]
201it [00:20,  9.52it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.64141, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>400it [00:40,  9.33it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.35076, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.54it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.61805, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:21,  9.43it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.41816, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.39it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.27354, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:02,  9.61it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>1.46630, 0.84375
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:23,  9.58it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.71938, 0.75000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.79it/s]
202it [00:20,  9.64it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.16202, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:40,  9.47it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.10540, 1.00000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>602it [01:01,  9.64it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.16295, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>802it [01:21,  9.69it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.14185, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.51it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.08471, 1.00000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:02,  9.46it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.20972, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:23,  9.38it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.31754, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.79it/s]
201it [00:20,  9.57it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.02871, 1.00000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>400it [00:40,  9.41it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.62937, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>600it [01:01,  9.41it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.17031, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:21,  9.31it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.30475, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.18417, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:03,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.29402, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1402it [02:24,  9.53it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.22230, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:40,  9.72it/s]
201it [00:20,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.15602, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.35it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.13093, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.37it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.16693, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.50it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.14665, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:43,  9.41it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.69271, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:03,  9.47it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.25087, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1400it [02:24,  9.23it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.67821, 0.78125
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:40,  9.72it/s]
201it [00:20,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.38167, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.37it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.27044, 0.87500
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.52it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.11917, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:22,  9.47it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.07680, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1001it [01:42,  9.58it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.36528, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1202it [02:03,  9.70it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.27552, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:23,  9.49it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.16641, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:40,  9.76it/s]
201it [00:20,  9.46it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.03546, 1.00000
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>401it [00:41,  9.46it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.18016, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>601it [01:01,  9.55it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.06724, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>801it [01:21,  9.44it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.35314, 0.90625
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1000it [01:42,  9.45it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.90582, 0.81250
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1201it [02:02,  9.54it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.22282, 0.96875
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1401it [02:23,  9.48it/s]</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>0.10338, 0.93750
</pre></div> </div> <div class="output_area"> <div class="output_subarea output_stream output_stderr output_text"><pre>1563it [02:39,  9.79it/s]
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>옵티마이저로 Adam을, 손실함수로 크로스엔트로피 함수를 사용합니다. 파이토치 내 전부 내장되어있죠.</p> <p>모델을 학습형태로 바꾼 뒤 설정한 에포크 만큼 학습을 진행하겠습니다. 20 에포크 코랩 무료 GPU 기준 1시간정도 걸리네요.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>torch.return_types.max(values=tensor([0.3000, 0.4000]), indices=tensor([2, 1]))</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>파이토치 내 max 함수를 사용했을때 결과입니다. 결과를 보시면 윗 반복문 내 if문을 저렇게 사용했는지 아실것 같습니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#53944;&#47112;&#51064;-&#45936;&#51060;&#53552;&#50640;-&#47784;&#45944;-&#51201;&#50857;&#54616;&#44592;">&#53944;&#47112;&#51064; &#45936;&#51060;&#53552;&#50640; &#47784;&#45944; &#51201;&#50857;&#54616;&#44592;<a class="anchor-link" href="#&#53944;&#47112;&#51064;-&#45936;&#51060;&#53552;&#50640;-&#47784;&#45944;-&#51201;&#50857;&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;sample_submission.csv&#39;</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

<span class="n">batch_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">batch_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">batch_size</span>
    <span class="n">max_vals</span><span class="p">,</span> <span class="n">max_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sample_submission</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">batch_index</span><span class="p">:</span><span class="n">batch_index</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">max_indices</span><span class="o">.</span><span class="n">long</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>모델을 평가모드로 바꾸고 (가중치 업데이트를 하지 않기 때문입니다.) 테스트 데이터 로더를 모델에 넣습니다.</p> <p>테스트 데이터도 마찬가지로 gpu 사용을 위해선 device에 넣어줘야 합니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;airplane&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;automobile&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s1">&#39;deer&#39;</span><span class="p">,</span>
          <span class="mi">5</span><span class="p">:</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="s1">&#39;frog&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="s1">&#39;ship&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span><span class="s1">&#39;truck&#39;</span><span class="p">}</span>
<span class="n">sample_submission</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_submission</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">sample_submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;dacon_object_1.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>숫자로 나온 값을 문자로 매핑시킨 뒤 csv 파일로 저장합니다. public 값 기준 0.7662정도 나왔는데 과적합이 된 것으로 보여요.</p> </div> </div> </div> </div> </div><script src="https://utteranc.es/client.js" repo="KSY1526/myblog" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async> </script> <a class="u-url" href="/myblog/jupyter/deep%20learning/pytorch/dacon/classifier/conputer%20vision/2022/02/24/torch4.html" hidden></a> </article> </div><div class="footer-wrapper"> <div class="footer-container"> <footer translate="no"> <div class="footer-text footer-text-centered long-copyright"> <p>&copy; 2022 Your Brand. </p><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" data-tooltip-no-hide title="Except where otherwise noted, content on this web site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License."> <img src="/myblog/assets/img/default/cc/cc.svg" alt="cc" width="12" height="12">&nbsp;<img src="/myblog/assets/img/default/cc/by.svg" alt="by" width="12" height="12">&nbsp;<img src="/myblog/assets/img/default/cc/sa.svg" alt="sa" width="12" height="12">&nbsp;<p>Some rights reserved.</p> </a></div> <p class="footer-powered"><span>Pwrd by </span><a href="https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme" target="_blank" rel="noopener noreferrer">Mr. Green</a></p> </footer> </div> </div> <div class="scroll-to-top-container"> <a id="scroll-to-top" href="#main-wrapper" class="hover-effect"><i class="fa fa-angle-up"></i></a> </div></div> <div class="searchbox-container"> <form id="searchbox-form" autocomplete="off"> <input type="search" id="search-box" placeholder="Search" onkeyup="if(this.value!==''){document.getElementById('search-results').style.display = 'block';}" onfocusout="this.value='';" onblur="setTimeout(function(){ document.getElementById('search-results').style.display = 'none'; }, 100);"> <ul id="search-results" ></ul> </form> </div> <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> <script src="/myblog/assets/js/main.js"></script> <script src="/myblog/assets/js/simple-jekyll-search-1.9.2.min.js"></script><script> function loadSearch(jsonData, searchParam) { if (!jsonData) jsonData = '/myblog'; var searchInput = document.getElementById('search-box'); const simpleJekyllSearch = SimpleJekyllSearch({ searchInput: searchInput ,resultsContainer: document.getElementById('search-results') ,json: jsonData ,searchResultTemplate: '<li> <a href="{url}"> <div> <div class="title">{title}</div> <div class="date">{date}</div> <div style="clear: both;"></div> </div> </a></li>' ,noResultsText: '<li>No results found.</li>' ,limit: 10 ,fuzzy: false ,formSubmit: document.getElementById('searchbox-form') }); if (searchParam) { searchInput.value = searchParam; searchInput.focus(); searchInput.disabled=false; setTimeout(function(){ simpleJekyllSearch.search(searchParam); }, 400); } } </script> <script> function isEmpty(value) { if (value === "" || value === null || typeof value === "undefined") return true; return false; } function getQueryParam (param, mach = true) { var queryString = window.location.search.substring(1); if (isEmpty(queryString)) return null; var queries = queryString.split("&"); for (var i in queries) { var pair = decodeURIComponent(queries[i]).split("="); if (mach == true){ if (pair[0] == param) { if (isEmpty(pair[1]) === false) return pair[1]; } }else{ return pair; } break; } return null; } const searchParam = getQueryParam('search'); (async () => { let resp = await fetch('/myblog'); if (!resp.ok) return; let jsonData = await resp.json(); loadSearch(jsonData, searchParam); })(); </script> <script> CookieConsent.consentSettingHtml = "<h5>Cookie settings</h5> <br> <p class=\"info-text\">This website uses cookies to optimize site functionality. It will be activated with your approval. Please click each item below for cookie policy. </p> <table> <tr> <td onclick=\"$('.info[data-consent-info=necessary]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Strictly necessary cookies</p> </td> <td> <span class=\"active_text\">Always active</span></td> </tr> </table> <div class=\"info\" data-consent-info=\"necessary\"> <p>These cookies are essential for the website function and cannot be disable. They are usually set when site function like color scheme etc. is changed. These cookies do not store any personally identifiable information. Enables storage related to security such as authentication functionality, fraud prevention, and other user protection. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=analytics]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Performance cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" checked=\"checked\" data-consent=\"analytics\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"analytics\"> <p>Enables storage (such as cookies) related to analytics e.g. visit duration. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=preferences]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Functionality cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"preferences\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"preferences\"> <p>Enables storage that supports the functionality of the website or app e.g. language settings. Enables storage related to personalization e.g. video recommendations. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=advertising]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Targeting and advertising cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"advertising\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"advertising\"> <p>Enables storage (such as cookies) related to advertising. </p> </div> <br> <div class=\"button-holder\"> <a href=\"javascript:void(0);\" class=\"btn-base btn-left\" onclick=\"CookieConsent.consentSettingDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentSettingDone('accept');\" role=\"button\">Allow all</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentSettingDone('save');\" role=\"button\">Allow selection</a> </div>"; CookieConsent.consentBarHtml = "<div class=\"consent-bar\"> <a class=\"close-button\" href=\"javascript:void(0);\" onclick=\"CookieConsent.hideConsentBar();\"><i class=\"fa-fw fa fa-times\"></i></a> <p>This website uses cookies to optimize site functionality. It will be activated with your approval. </p> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('settings');\" role=\"button\">Customize</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentBarDone('accept');\" role=\"button\">Allow all</a> </div>"; CookieConsent.consent_items = JSON.parse('{"necessary":{"group":["security_storage"],"value":"granted","wait_for_update":500,"cookie_domain":"","no_check_box":true},"analytics":{"group":["analytics_storage"],"value":"denied"},"preferences":{"group":["functionality_storage","personalization_storage"],"value":"denied"},"advertising":{"group":["ad_storage"],"value":"denied"}}'); CookieConsent.hideConsentBarWithSaveButton = true; const consent_settings = CookieConsent.getConsentSettings(); const default_configs = JSON.parse('{"anonymize_ip":true,"ads_data_redaction":true,"cookie_flags":"SameSite=None;Secure"}'); </script> <script> SlidingMsgBox.html = "<div class=\"slideBox slideBoxTopToDown\"> <a class=\"close-button\" href=\"javascript:void(0);\"><i class=\"fa-fw fa fa-times\"></i></a> </div>"; </script> <script> LangOfferMsgBox.currentPageLng = "en"; LangOfferMsgBox.supportedLngList = [["en","En","/myblog/","View this page in English.","To English home page","Language"],["ja","Jp","/myblog/ja","このページを日本語で表示する。","日本語ホームへ","言語"]]; LangOfferMsgBox.existLng = []; LangOfferMsgBox.disableExtTranslationOffer = true; </script> </body> </html>
