<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Your Brand - [처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN</title> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" media="print" onload="this.media='all'"> <noscript> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"> </noscript> <link rel="shortcut icon" href="/myblog/assets/img/favicons/favicon.ico"> <link rel="icon" type="image/png" sizes="32x32" href="/myblog/assets/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/myblog/assets/img/favicons/favicon-16x16.png"> <link rel="apple-touch-icon" sizes="180x180" href="/myblog/assets/img/favicons/apple-touch-icon.png"> <link rel="manifest" href="/myblog/assets/manifest.json"> <meta name="mobile-web-app-capable" content="yes"> <meta name="theme-color" content="#f0f0f0"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-title" content="Your Brand's App"> <meta name="apple-mobile-web-app-status-bar-style" content="default"> <meta name="msapplication-TileColor" content="#2d89ef"> <meta name="msapplication-starturl" content="/myblog/"> <meta name="application-name" content="Your Brand's App"> <meta name="msapplication-config" content="/myblog/assets/img/favicons/browserconfig.xml"> <meta name="keywords" content=""> <meta name="description" content="Your meta description."> <meta name="robots" content="index, follow"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="[처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN"> <meta name="twitter:description" content="Your meta description."> <meta name="twitter:image" content="https://ksy1526.github.io/myblog/assets/img/about/about.jpg"> <meta property="og:site_name" content="Your Brand"> <meta property="og:type" content="website"> <meta property="og:title" content="[처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN"> <meta property="og:description" content="Your meta description."> <meta property="og:url" content="https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html"> <meta property="og:image" content="https://ksy1526.github.io/myblog/assets/img/about/about.jpg"> <script type="application/ld+json">{ "@context": "https://schema.org" ,"@graph": [ { "@type": "Person" ,"@id": "https://ksy1526.github.io/myblog/#person" ,"name": "Seong Yeon Kim" ,"url": "" ,"image": "https://ksy1526.github.io/myblog/assets/img/about/about.jpg" ,"description": "Your meta description." },{ "@type": "WebSite" ,"@id": "https://ksy1526.github.io/myblog/#website" ,"url": "https://ksy1526.github.io/myblog/" ,"name": "Your Brand" ,"description": "Your meta description." ,"publisher": {"@id": "https://ksy1526.github.io/myblog/#person"} ,"inLanguage": "en-US" ,"copyrightHolder" : {"@id": "https://ksy1526.github.io/myblog/#person"} ,"copyrightYear" : "2022" },{ "@type": "WebPage" ,"@id": "https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html#webpage" ,"url": "https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html" ,"name": "[처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN" ,"isPartOf": {"@id": "https://ksy1526.github.io/myblog/#website"} ,"breadcrumb": {"@id": "https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html#breadcrumb"} ,"primaryImageOfPage": "https://ksy1526.github.io/myblog/assets/img/about/about.jpg" ,"description": "Your meta description." ,"inLanguage": "en-US" ,"potentialAction": { "@type": "ReadAction" ,"target": "https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html" } },{ "@type": "BreadcrumbList", "@id": "https://ksy1526.github.io/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html#breadcrumb", "itemListElement": [ { "@type": "ListItem" ,"position": 1 ,"name": "Home" ,"item": "https://ksy1526.github.io/myblog/" }, { "@type": "ListItem" ,"position": 2 ,"name": "[처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN" } ] } ] }</script> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <link href="/myblog/assets/css/main.css" rel="stylesheet"><link href="/myblog/assets/css/nav-media.css" rel="stylesheet"> </head> <body > <script src="/myblog/assets/js/color-scheme-attr-init.js" data-mode="false"></script> <nav class="navbar navbar-default top-nav"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed pull-left top-nav-menu-toggle" data-toggle="collapse" data-target="#id_top-nav-menu-toggle" aria-expanded="false"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand top-nav-brand" href="/myblog/" translate="no">Your Brand</a> </div> <div class="color_scheme_switch_top_holder" data-toggle="tooltip" data-placement="bottom" title="Color scheme"> <label class="color-scheme-switch hover-effect"> <input type="checkbox" class="checkbox_color_switch" /> <span></span> </label> </div> </nav> <nav id="side-nav-container"> <div class="side-nav"> <div class="side-nav-brand"> <img src="/myblog/assets/img/posts/post_pic1.jpg" alt=""> <div class="brand-holder"> <a href="/myblog/" translate="no">Your Brand</a> </div> <p>&nbsp;Sample</p> <br> </div> <br> <a href="javascript:void(0);" class="side-nav-close"> <i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i> </a> <hr> <br> <div class="side-nav-buttons"> <ul class="nav nav-pills nav-stacked"> <li ><a href="/myblog/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page2/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page3/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page4/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page5/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/myblog/page6/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li></ul> </div> <br> <br> <hr id="toc-view-top"> <div class="side-nav-footer" translate="no"> <p>&copy; 2022 Your Brand.</p> </div> </div> <div class="side-nav-bottom-buttons-container"> <hr> <ul> <li><div class="color_scheme_switch_side_holder" data-toggle="tooltip" data-placement="top" title="Color scheme"> <label class="color-scheme-switch hover-effect"> <input type="checkbox" class="checkbox_color_switch" /> <span></span> </label> </div> </li><li><div class="cookie-icon hover-effect" onclick="CookieConsent.showSettings();" data-toggle="tooltip" data-placement="top" title="Cookie settings"> <div class="cookie-wrapper"> <i class="fa fa-circle bitten-cookie" aria-hidden="true"></i> <i class="fa fa-circle small-ellipse-icon" aria-hidden="true"></i> <i class="fa fa-spinner inner-icon" aria-hidden="true"></i> <i class="fa fa-circle-thin outer-icon" aria-hidden="true"></i> </div> </div> </li></ul> </div></nav> <div id="main-wrapper"> <div class="main-container"><article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title p-name" itemprop="name headline">[처음 시작하는 딥러닝] 3. 밑바닥부터 만들어보는 CNN</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-23T00:00:00-06:00" itemprop="datePublished"> Jan 23, 2022 </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span class="p-author h-card" itemprop="name">Seong Yeon Kim</span></span> • <span class="read-time" title="Estimated read time"> 8 min read </span></p> <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> <a class="category-tags-link" href="/myblog/categories/#book">book</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#jupyter">jupyter</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#Deep Learning">Deep Learning</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#matrix">matrix</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#math">math</a> &nbsp; <a class="category-tags-link" href="/myblog/categories/#class">class</a> </p> <div class="pb-5 d-flex flex-wrap flex-justify-end"> </div> </header> <div class="post-content e-content" itemprop="articleBody"> <!-- ################################################# ### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ### ################################################# # file to edit: _notebooks/2022-01-23-FirstDeep3.ipynb --> <div class="container" id="notebook-container"> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p><a href="https://colab.research.google.com/github/KSY1526/myblog/blob/master/_notebooks/2022-01-23-FirstDeep3.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#44592;&#48376;-&#49464;&#54021;">&#44592;&#48376; &#49464;&#54021;<a class="anchor-link" href="#&#44592;&#48376;-&#49464;&#54021;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ndarray</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">assert_same_shape</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">output_grad</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">output_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> \
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    두 ndarray의 모양이 같아야 하는데,</span>
<span class="sd">    첫 번째 ndarray의 모양은 {0}이고</span>
<span class="sd">    두 번째 ndarray의 모양은 {1}이다.</span>
<span class="sd">    &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">output_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">assert_dim</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="n">dim</span><span class="p">,</span> \
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    이 텐서는 {0}차원이어야 하는데, {1}차원이다.</span>
<span class="sd">    &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>필요한 차원을 잘 입력했는지 확인하는 함수를 선언합니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="1&#52264;&#50896;-&#54633;&#49457;-&#44273;">1&#52264;&#50896; &#54633;&#49457; &#44273;<a class="anchor-link" href="#1&#52264;&#50896;-&#54633;&#49457;-&#44273;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">input_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">param_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_pad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span> <span class="c1"># 원래 데이터와 패딩 길이 입력</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">z</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>

<span class="n">_pad_1d</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([0, 1, 2, 3, 4, 5, 0])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>간단한 함수로 1차원 데이터를 패딩한 모습입니다.</p> <p>입력 데이터와 합성곱 연산을 한 출력 데이터의 크기를 같게하기 위해선 벗어나는 범위에 대해서 0 값을 채워주는 패딩을 하게 됩니다.</p> <p>패딩 크기는 필터 크기를 2로 나눈 값에 정수부분이 입력과 출력을 같게하는 패딩의 크기가 됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">conv_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span> <span class="c1"># 입력 값과 필터 값 입력</span>
    <span class="c1"># 1차원 입력인지 확인합니다</span>
    <span class="n">assert_dim</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">assert_dim</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># 입력 값에 패딩을 덧붙입니다.</span>
    <span class="n">param_len</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">param_mid</span> <span class="o">=</span> <span class="n">param_len</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">input_pad</span> <span class="o">=</span> <span class="n">_pad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>

    <span class="c1"># 초기값 부여</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># 1차원 합성곱 연산 수행</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_len</span><span class="p">):</span>
            <span class="n">out</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">+=</span> <span class="n">param</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">input_pad</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="n">p</span><span class="p">]</span>

    <span class="c1"># 출력 모양이 입력과 동일한지 확인</span>
    <span class="n">assert_same_shape</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out</span>

<span class="n">conv_1d</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([ 3.,  6.,  9., 12.,  9.])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>가중치가 [1,1,1] 인 간단한 합성곱 연산을 진행했습니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">conv_1d_sum</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span> 
    <span class="n">out</span> <span class="o">=</span> <span class="n">conv_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

<span class="n">input_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">input_1d_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_1d_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="n">param_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">param_1d_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">conv_1d_sum</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv_1d_sum</span><span class="p">(</span><span class="n">input_1d_2</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv_1d_sum</span><span class="p">(</span><span class="n">input_1d_3</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">conv_1d_sum</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="n">param_1d_2</span><span class="p">))</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_subarea output_stream output_stdout output_text"><pre>39.0
41.0
42.0
49.0
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>입력값과 필터값이 달라짐에 따라 출력값의 합이 어떻게 바뀌는지 비교했습니다.</p> <p>끝 쪽 입력값이 1 증가할때는 출력값의 합이 2증가, 가운데 쪽 입력값(패딩 영향 안받는)이 1 증가할때는 출력값의 합이 3증가합니다.</p> <p>또 필터값이 1 증가할때 출력값의 합이 10 증가합니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_param_grad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">output_grad</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="c1"># 입력값 패딩 추가</span>
    <span class="n">param_len</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">param_mid</span> <span class="o">=</span> <span class="n">param_len</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">input_pad</span> <span class="o">=</span> <span class="n">_pad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_grad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># 출력값의 기울기를 입력하지 않으면 1로 초기화.</span>
        <span class="c1"># 왜냐하면 출력값의 합의 기울기이기 때문에 기울기를 유지하는 1을 쓰면됨.</span>
        <span class="n">output_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">assert_same_shape</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">output_grad</span><span class="p">)</span>

    <span class="c1"># 모든 기울기의 초기값을 0으로 줍니다.</span>
    <span class="n">param_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">input_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 0~4</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 0~2</span>
            <span class="c1"># 필터값의 기울기는 실제 영향을 받는 입력값의 합으로 됨</span>
            <span class="n">param_grad</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="n">input_pad</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">output_grad</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
    
    <span class="n">assert_same_shape</span><span class="p">(</span><span class="n">param_grad</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">param_grad</span>

<span class="n">_param_grad_1d</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([10, 15, 14])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>1차원 합성 곱의 역방향 함수중 먼저 필터(파라미터) 기울기를 구하는 함수 입니다.</p> <p>조금 어려운데 결과값을 간단히 해석하면 파라미터가 1 증가했을때 출력값의 합이 각각 10, 15, 14 증가한다는 것 입니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_input_grad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">output_grad</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="c1"># 입력값 패딩 추가</span>
    <span class="n">param_len</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">param_mid</span> <span class="o">=</span> <span class="n">param_len</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">input_pad</span> <span class="o">=</span> <span class="n">_pad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_grad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># 출력값의 기울기를 입력하지 않으면 1로 초기화.</span>
        <span class="c1"># 왜냐하면 출력값의 합의 기울기이기 때문에 기울기를 유지하는 1을 쓰면됨.</span>
        <span class="n">output_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">assert_same_shape</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">output_grad</span><span class="p">)</span>

    <span class="c1"># 원할한 연산을 위해 범위 내 값은 1을, 범위를 벗어나는 것들은 0으로함.</span>
    <span class="c1"># 패딩도 같은 효과를 냄.</span>
    <span class="n">output_pad</span> <span class="o">=</span> <span class="n">_pad_1d</span><span class="p">(</span><span class="n">output_grad</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>

    <span class="c1"># 모든 기울기의 초기값을 0으로 줍니다.</span>
    <span class="n">param_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">input_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 0~4</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 0~2</span>
            <span class="c1"># 입력값의 기울기는 실제 영향을 받는 필터값의 합으로 됨</span>
            <span class="n">input_grad</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">+=</span> <span class="n">output_pad</span><span class="p">[</span><span class="n">o</span> <span class="o">+</span> <span class="n">param_len</span> <span class="o">-</span> <span class="n">f</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">param</span><span class="p">[</span><span class="n">f</span><span class="p">]</span>
    
    <span class="n">assert_same_shape</span><span class="p">(</span><span class="n">param_grad</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">input_grad</span>

<span class="n">_input_grad_1d</span><span class="p">(</span><span class="n">input_1d</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([2, 3, 3, 3, 2])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>입력값에 따른 출력값의 변동이 얼마나 되는지를 나타내는 함수 입니다.</p> <p>첫번째와 마지막은 입력값이 1 증가할때 크기가 1 작은 2만큼 증가하고 나머지 값들은 3만큼 증가합니다.</p> <p>패딩한 것에 영향받는 값을 제외하고 필터의 개수(3)만큼 영향력이 있다고 생각하면 됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#48176;&#52824;-&#51077;&#47141;-&#51201;&#50857;&#54616;&#44592;">&#48176;&#52824; &#51077;&#47141; &#51201;&#50857;&#54616;&#44592;<a class="anchor-link" href="#&#48176;&#52824;-&#51077;&#47141;-&#51201;&#50857;&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">input_1d_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                           <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">_pad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_pad_1d</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span>

<span class="n">_pad_1d_batch</span><span class="p">(</span><span class="n">input_1d_batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([[0, 0, 1, 2, 3, 4, 5, 6, 0],
       [0, 1, 2, 3, 4, 5, 6, 7, 0]])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>입력값이 2개 이상인 배치에도 적용하기 위해 기존 구현한 함수를 확장하겠습니다.</p> <p>패딩의 경우 기존함수를 반복문을 이용해서 여러번 호출하면 됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">conv_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">conv_1d</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span>

<span class="n">conv_1d_batch</span><span class="p">(</span><span class="n">input_1d_batch</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([[ 1.,  3.,  6.,  9., 12., 15., 11.],
       [ 3.,  6.,  9., 12., 15., 18., 13.]])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>순방향 계산에 경우에도 같은 방식으로 확장했습니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">input_grad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">conv_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
    <span class="n">out_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="c1"># 출력기울기 값의 형태가 배치이므로 이에 맞게 조정</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">out_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 배치 크기가 나옴</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="p">[</span><span class="n">_input_grad_1d</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">param</span><span class="p">,</span> <span class="n">out_grad</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">grads</span><span class="p">)</span>

<span class="n">input_grad_1d_batch</span><span class="p">(</span><span class="n">input_1d_batch</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([[2, 3, 3, 3, 3, 3, 2],
       [2, 3, 3, 3, 3, 3, 2]])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>입력값에 따른 출력값이 얼마나 되는지 구하는 함수를 배치로 확장했습니다.</p> <p>기울기는 입력값에 영향이 있지 않기 때문에 어느 입력값이 입력되던 그대로 출력됩니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">param_grad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">output_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="c1"># 단순 합의 기울기이기 때문에 모든 값을 1로 둡니다.</span>

    <span class="n">inp_pad</span> <span class="o">=</span> <span class="n">_pad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">out_pad</span> <span class="o">=</span> <span class="n">_pad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">param_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 배치 크기만큼</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># 인풋 길이만큼</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 필터 길이만큼</span>
                <span class="c1"># 전부 합해줍니다.</span>
                <span class="n">param_grad</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="n">inp_pad</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="o">+</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">output_grad</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">param_grad</span>

<span class="n">param_grad_1d_batch</span><span class="p">(</span><span class="n">input_1d_batch</span><span class="p">,</span> <span class="n">param_1d</span><span class="p">)</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([36, 49, 48])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>필터값에 따른 출력값이 얼마나 변하는지를 구하는 함수를 배치로 확장했습니다.</p> <p>이때 필터에 대한 기울기는 배치 단위인데 필터는 모든 관찰과 합성곱 연선이 이뤄지므로 모든 값을 다 더해야합니다.</p> <p>즉 모든 요소의 합이 필터 값이 바뀜에 따라서 얼마나 바뀌는지를 구하는 것 입니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="2&#52264;&#50896;-&#54633;&#49457;&#44273;">2&#52264;&#50896; &#54633;&#49457;&#44273;<a class="anchor-link" href="#2&#52264;&#50896;-&#54633;&#49457;&#44273;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="n">imgs_2d_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">param_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_pad_2d_obs</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="c1"># 가로 단위로 앞 뒷 값 각각 패딩</span>
    <span class="n">inp_pad</span> <span class="o">=</span> <span class="n">_pad_1d_batch</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="c1"># 가로로 윗 2줄, 아래 2줄 패딩</span>
    <span class="n">other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">other</span><span class="p">,</span> <span class="n">inp_pad</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">_pad_2d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
    <span class="c1"># 첫번째 차원은 배치 크기에 해당함.</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_pad_2d_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span>

<span class="n">_pad_2d</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>(3, 30, 30)</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>2차원 단위에 입력값을 가지고 패딩을 진행했습니다.</p> <p>_pad_2d_obs 함수는 패딩을 실질적으로 진행하는 함수이고, _pad_2d 함수는 배치 단위로 확장하는 함수 입니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_compute_output_obs_2d</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">param_mid</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
    
    <span class="n">obs_pad</span> <span class="o">=</span> <span class="n">_pad_2d_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

    <span class="c1"># 2차원 필터를 거처 출력값을 만듭니다.</span>
    <span class="k">for</span> <span class="n">o_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 출력값 가로길이</span>
        <span class="k">for</span> <span class="n">o_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># 출력값 세로길이</span>
            <span class="k">for</span> <span class="n">p_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 필터 가로길이</span>
                <span class="k">for</span> <span class="n">p_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># 필터 세로길이</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">o_w</span><span class="p">][</span><span class="n">o_h</span><span class="p">]</span> <span class="o">+=</span> <span class="n">param</span><span class="p">[</span><span class="n">p_w</span><span class="p">][</span><span class="n">p_h</span><span class="p">]</span> <span class="o">*</span> <span class="n">obs_pad</span><span class="p">[</span><span class="n">o_w</span><span class="o">+</span><span class="n">p_w</span><span class="p">][</span><span class="n">o_h</span><span class="o">+</span><span class="n">p_h</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">out</span>

<span class="k">def</span> <span class="nf">_compute_output_2d</span><span class="p">(</span><span class="n">img_batch</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">assert_dim</span><span class="p">(</span><span class="n">img_batch</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_compute_output_obs_2d</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">img_batch</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span>

<span class="n">_compute_output_2d</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">,</span> <span class="n">param_2d</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>(3, 28, 28)</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>2차원 단위에 순방향 계산입니다. 패딩을 먼저 시킨 뒤 2차원 필터를 통과시켜 모든 값을 합친 값을 출력해줍니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_compute_grads_obs_2d</span><span class="p">(</span><span class="n">input_obs</span><span class="p">,</span> <span class="n">output_grad_obs</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="c1"># 입력을 나타내는 2차원값, 출력 기울기를 나타내는 2차원값(여기선 모두 1을 사용), 2차원 필터</span>

    <span class="n">param_size</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 2차원 필터의 가로 세로가 같다고 가정합니다.</span>

    <span class="c1"># 출력 기울기에 패딩을 먼저 덧붙입니다. 원본값은 1로, 나머지 값은 0으로하여 원본값만 유지하게 합니다.</span>
    <span class="n">output_obs_pad</span> <span class="o">=</span> <span class="n">_pad_2d_obs</span><span class="p">(</span><span class="n">output_grad_obs</span><span class="p">,</span> <span class="n">param_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">input_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">input_obs</span><span class="p">)</span> <span class="c1"># 초기 기울기는 0으로 합니다.</span>

    <span class="k">for</span> <span class="n">i_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">input_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 입력값 가로길이</span>
        <span class="k">for</span> <span class="n">i_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">input_obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># 입력값 세로길이</span>
            <span class="k">for</span> <span class="n">p_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span> <span class="c1"># 필터 가로길이</span>
                <span class="k">for</span> <span class="n">p_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span> <span class="c1"># 필터 세로길이</span>
                    <span class="n">input_grad</span><span class="p">[</span><span class="n">i_w</span><span class="p">][</span><span class="n">i_h</span><span class="p">]</span> <span class="o">+=</span> <span class="n">output_obs_pad</span><span class="p">[</span><span class="n">i_w</span> <span class="o">+</span> <span class="n">param_size</span> <span class="o">-</span> <span class="n">p_w</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i_h</span> <span class="o">+</span> <span class="n">param_size</span> <span class="o">-</span> <span class="n">p_h</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">param</span><span class="p">[</span><span class="n">p_w</span><span class="p">][</span><span class="n">p_h</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">input_grad</span>

<span class="k">def</span> <span class="nf">_compute_grads_2d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">output_grad</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    
    <span class="n">grads</span> <span class="o">=</span> <span class="p">[</span><span class="n">_compute_grads_obs_2d</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">output_grad</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">grads</span><span class="p">)</span>

<span class="n">img_grads</span> <span class="o">=</span> <span class="n">_compute_grads_2d</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">),</span> <span class="n">param_2d</span><span class="p">)</span>
<span class="n">img_grads</span><span class="o">.</span><span class="n">shape</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>(3, 28, 28)</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>역방향 계산을 2차원으로 구현했습니다. 그 중 입력 기울기를 계산하는 절차인데요.</p> <p>출력 기울기에 패딩을 덧붙이고 해당하는 가중치와의 합 연산을 하면 입력 기울기를 계산할 수 있습니다.</p> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_param_grad_2d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">output_grad</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="c1"># 입력을 나타내는 3차원값, 출력 기울기를 나타내는 3차원값(여기선 모두 1을 사용), 2차원 필터</span>

    <span class="n">param_size</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 2차원 필터의 가로 세로가 같다고 가정합니다.</span>
    <span class="n">inp_pad</span> <span class="o">=</span> <span class="n">_pad_2d</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># 입력 값을 패딩합니다.</span>

    <span class="n">param_grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="c1"># 초기 가중치 기울기를 0으로 합니다.</span>
    <span class="n">img_shape</span> <span class="o">=</span> <span class="n">output_grad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c1"># 첫 값은 배치크기이므로 빼고 실행하기 위해.</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 배치 크기</span>
        <span class="k">for</span> <span class="n">o_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># 입력값 가로길이</span>
            <span class="k">for</span> <span class="n">o_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># 입력값 세로길이</span>
                <span class="k">for</span> <span class="n">p_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span> <span class="c1"># 필터 가로길이</span>
                    <span class="k">for</span> <span class="n">p_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span> <span class="c1"># 필터 세로길이</span>
                        <span class="n">param_grad</span><span class="p">[</span><span class="n">p_w</span><span class="p">][</span><span class="n">p_h</span><span class="p">]</span> <span class="o">+=</span> <span class="n">inp_pad</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o_w</span><span class="o">+</span><span class="n">p_w</span><span class="p">][</span><span class="n">o_h</span><span class="o">+</span><span class="n">p_h</span><span class="p">]</span> <span class="o">*</span> <span class="n">output_grad</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o_w</span><span class="p">][</span><span class="n">o_h</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">param_grad</span>

<span class="n">param_grad</span> <span class="o">=</span> <span class="n">_param_grad_2d</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">imgs_2d_batch</span><span class="p">),</span> <span class="n">param_2d</span><span class="p">)</span>
<span class="n">param_grad</span>
</pre></div> </div> </div> </div> <div class="output_wrapper"> <div class="output"> <div class="output_area"> <div class="output_text output_subarea output_execute_result"><pre>array([[108.03493534, 116.92134058, 112.40044695],
       [112.79682302, 122.16317892, 122.1838074 ],
       [106.24163816, 116.07072373, 116.86259153]])</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>역방향 계산 중 필터 기울기를 구하는 부분을 2차원으로 구현했습니다.</p> <p>여기서는 입력값에 패딩을 덧붙이고 합 연산을 했는데, 1차원하고 크게 다를게 없습니다.</p> <p>배치 연산까지 한번에 진행하는 함수를 구현했는데 모든 배치의 입력값을 순회합니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#52292;&#45328;-&#52628;&#44032;&#54616;&#44592;">&#52292;&#45328; &#52628;&#44032;&#54616;&#44592;<a class="anchor-link" href="#&#52292;&#45328;-&#52628;&#44032;&#54616;&#44592;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing code_cell rendered"> <div class="input"> <div class="inner_cell"> <div class="input_area"> <div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">_compute_output_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">assert_dim</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">assert_dim</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    
    <span class="n">param_size</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">param_mid</span> <span class="o">=</span> <span class="n">param_size</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">obs_pad</span> <span class="o">=</span> <span class="n">_pad_2d_channel</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param_mid</span><span class="p">)</span>
    
    <span class="n">in_channels</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">out_channels</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">img_size</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">out_channels</span><span class="p">,)</span> <span class="o">+</span> <span class="n">obs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">for</span> <span class="n">c_in</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">in_channels</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c_out</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">out_channels</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">o_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_size</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">o_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img_size</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">p_w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">p_h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">param_size</span><span class="p">):</span>
                            <span class="n">out</span><span class="p">[</span><span class="n">c_out</span><span class="p">][</span><span class="n">o_w</span><span class="p">][</span><span class="n">o_h</span><span class="p">]</span> <span class="o">+=</span> \
                            <span class="n">param</span><span class="p">[</span><span class="n">c_in</span><span class="p">][</span><span class="n">c_out</span><span class="p">][</span><span class="n">p_w</span><span class="p">][</span><span class="n">p_h</span><span class="p">]</span> <span class="o">*</span> <span class="n">obs_pad</span><span class="p">[</span><span class="n">c_in</span><span class="p">][</span><span class="n">o_w</span><span class="o">+</span><span class="n">p_w</span><span class="p">][</span><span class="n">o_h</span><span class="o">+</span><span class="n">p_h</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">out</span>
 

<span class="k">def</span> <span class="nf">_output</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="p">[</span><span class="n">_compute_output_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">inp</span><span class="p">]</span>    

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">outs</span><span class="p">)</span>
</pre></div> </div> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>합성곱층은 2차원으로 서로 엮인 뉴런 외에도 특징 맵과 같은 수의 채널을 갖습니다.</p> <p>이런식으로 입력된 데이터를 다루기 위해 채널이 있는 순방향 연산을 구현했습니다. 역방향 연산은 생략합니다.</p> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <h1 id="&#44592;&#53440;-&#44032;&#48316;&#50868;-&#51060;&#47200;">&#44592;&#53440; &#44032;&#48316;&#50868; &#51060;&#47200;<a class="anchor-link" href="#&#44592;&#53440;-&#44032;&#48316;&#50868;-&#51060;&#47200;"> </a></h1> </div> </div> </div> <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"> <div class="text_cell_render border-box-sizing rendered_html"> <p>이미지 데이터에서는 서로 가까운 픽셀 간에 유의미한 의미가 있는 조합이 나올 가능성이 높습니다.</p> <p>즉 픽셀간 얼마나 공간적으로 가까운지를 나타내기 위해 합성곱 연산을 수행합니다.</p> <p>풀링이란 각 특징 맵을 다운샘플링하여 데이터의 크기를 줄이는 방법입니다. 예시로 각 영역 픽셀 값의 최대값을 사용할 수 있습니다.</p> <p>계산양 감소라는 이점이 있으나, 정보 손실또한 크기 때문에 이 방법을 쓰는데 다양한 의견이 있습니다.</p> <p>스트라이드란 필터가 움직이는 간격이 지금까지는 1이였는데 이 값을 의미하는 용어로 커질수록 다운샘플링 효과가 커집니다.</p> <p>최근 제안되는 고급 합성곱 신경망 구조에서는 풀링 대신 스트라이드를 2이상으로 설정해 다운샘플링 효과를 얻습니다.</p> </div> </div> </div> </div> </div><script src="https://utteranc.es/client.js" repo="KSY1526/myblog" issue-term="pathname" theme="github-dark" crossorigin="anonymous" async> </script> <a class="u-url" href="/myblog/book/jupyter/deep%20learning/matrix/math/class/2022/01/23/FirstDeep3.html" hidden></a> </article> </div><div class="footer-wrapper"> <div class="footer-container"> <footer translate="no"> <div class="footer-text footer-text-centered long-copyright"> <p>&copy; 2022 Your Brand. </p><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" data-tooltip-no-hide title="Except where otherwise noted, content on this web site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License."> <img src="/myblog/assets/img/default/cc/cc.svg" alt="cc" width="12" height="12">&nbsp;<img src="/myblog/assets/img/default/cc/by.svg" alt="by" width="12" height="12">&nbsp;<img src="/myblog/assets/img/default/cc/sa.svg" alt="sa" width="12" height="12">&nbsp;<p>Some rights reserved.</p> </a></div> <p class="footer-powered"><span>Pwrd by </span><a href="https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme" target="_blank" rel="noopener noreferrer">Mr. Green</a></p> </footer> </div> </div> <div class="scroll-to-top-container"> <a id="scroll-to-top" href="#main-wrapper" class="hover-effect"><i class="fa fa-angle-up"></i></a> </div></div> <div class="searchbox-container"> <form id="searchbox-form" autocomplete="off"> <input type="search" id="search-box" placeholder="Search" onkeyup="if(this.value!==''){document.getElementById('search-results').style.display = 'block';}" onfocusout="this.value='';" onblur="setTimeout(function(){ document.getElementById('search-results').style.display = 'none'; }, 100);"> <ul id="search-results" ></ul> </form> </div> <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script> <script src="/myblog/assets/js/main.js"></script> <script src="/myblog/assets/js/simple-jekyll-search-1.9.2.min.js"></script><script> function loadSearch(jsonData, searchParam) { if (!jsonData) jsonData = '/myblog'; var searchInput = document.getElementById('search-box'); const simpleJekyllSearch = SimpleJekyllSearch({ searchInput: searchInput ,resultsContainer: document.getElementById('search-results') ,json: jsonData ,searchResultTemplate: '<li> <a href="{url}"> <div> <div class="title">{title}</div> <div class="date">{date}</div> <div style="clear: both;"></div> </div> </a></li>' ,noResultsText: '<li>No results found.</li>' ,limit: 10 ,fuzzy: false ,formSubmit: document.getElementById('searchbox-form') }); if (searchParam) { searchInput.value = searchParam; searchInput.focus(); searchInput.disabled=false; setTimeout(function(){ simpleJekyllSearch.search(searchParam); }, 400); } } </script> <script> function isEmpty(value) { if (value === "" || value === null || typeof value === "undefined") return true; return false; } function getQueryParam (param, mach = true) { var queryString = window.location.search.substring(1); if (isEmpty(queryString)) return null; var queries = queryString.split("&"); for (var i in queries) { var pair = decodeURIComponent(queries[i]).split("="); if (mach == true){ if (pair[0] == param) { if (isEmpty(pair[1]) === false) return pair[1]; } }else{ return pair; } break; } return null; } const searchParam = getQueryParam('search'); (async () => { let resp = await fetch('/myblog'); if (!resp.ok) return; let jsonData = await resp.json(); loadSearch(jsonData, searchParam); })(); </script> <script> CookieConsent.consentSettingHtml = "<h5>Cookie settings</h5> <br> <p class=\"info-text\">This website uses cookies to optimize site functionality. It will be activated with your approval. Please click each item below for cookie policy. </p> <table> <tr> <td onclick=\"$('.info[data-consent-info=necessary]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Strictly necessary cookies</p> </td> <td> <span class=\"active_text\">Always active</span></td> </tr> </table> <div class=\"info\" data-consent-info=\"necessary\"> <p>These cookies are essential for the website function and cannot be disable. They are usually set when site function like color scheme etc. is changed. These cookies do not store any personally identifiable information. Enables storage related to security such as authentication functionality, fraud prevention, and other user protection. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=analytics]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Performance cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" checked=\"checked\" data-consent=\"analytics\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"analytics\"> <p>Enables storage (such as cookies) related to analytics e.g. visit duration. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=preferences]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Functionality cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"preferences\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"preferences\"> <p>Enables storage that supports the functionality of the website or app e.g. language settings. Enables storage related to personalization e.g. video recommendations. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=advertising]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Targeting and advertising cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"advertising\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"advertising\"> <p>Enables storage (such as cookies) related to advertising. </p> </div> <br> <div class=\"button-holder\"> <a href=\"javascript:void(0);\" class=\"btn-base btn-left\" onclick=\"CookieConsent.consentSettingDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentSettingDone('accept');\" role=\"button\">Allow all</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentSettingDone('save');\" role=\"button\">Allow selection</a> </div>"; CookieConsent.consentBarHtml = "<div class=\"consent-bar\"> <a class=\"close-button\" href=\"javascript:void(0);\" onclick=\"CookieConsent.hideConsentBar();\"><i class=\"fa-fw fa fa-times\"></i></a> <p>This website uses cookies to optimize site functionality. It will be activated with your approval. </p> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('deny');\" role=\"button\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('settings');\" role=\"button\">Customize</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentBarDone('accept');\" role=\"button\">Allow all</a> </div>"; CookieConsent.consent_items = JSON.parse('{"necessary":{"group":["security_storage"],"value":"granted","wait_for_update":500,"cookie_domain":"","no_check_box":true},"analytics":{"group":["analytics_storage"],"value":"denied"},"preferences":{"group":["functionality_storage","personalization_storage"],"value":"denied"},"advertising":{"group":["ad_storage"],"value":"denied"}}'); CookieConsent.hideConsentBarWithSaveButton = true; const consent_settings = CookieConsent.getConsentSettings(); const default_configs = JSON.parse('{"anonymize_ip":true,"ads_data_redaction":true,"cookie_flags":"SameSite=None;Secure"}'); </script> <script> SlidingMsgBox.html = "<div class=\"slideBox slideBoxTopToDown\"> <a class=\"close-button\" href=\"javascript:void(0);\"><i class=\"fa-fw fa fa-times\"></i></a> </div>"; </script> <script> LangOfferMsgBox.currentPageLng = "en"; LangOfferMsgBox.supportedLngList = [["en","En","/myblog/","View this page in English.","To English home page","Language"],["ja","Jp","/myblog/ja","このページを日本語で表示する。","日本語ホームへ","言語"]]; LangOfferMsgBox.existLng = []; LangOfferMsgBox.disableExtTranslationOffer = true; </script> </body> </html>
